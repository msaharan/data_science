metadata:
  createdAt: 2025-12-12T21:27:15.137Z
project:
  id: a021eeda-c802-4a18-aaa2-0f24dc64b1db
  integrations: []
  name: tutorial-intro-hugging-face-nlp-pytorch
  notebooks:
    - blocks:
        - blockGroup: 0de8e98c-17de-47c9-9f36-43d08da63c45
          content: >-
            # Tutorial: getting starting with Hugging Face, NLP, NVIDIA
            CUDA-accelerated PyTorch, sentiment analysis. 


            - Download the official Booking.com accommodation reviews data from
            Hugging Face

            - Get introduced to the tools used for natural language processind
            (NLP): Hugging Face Transformers, PyTorch, and pre-trained language
            models

            - Fine-tune a pre-trained language model on the Booking.com
            accommodation review dataset to classify the sentiment of the
            review 
          id: b45cb15b-7ed1-41ab-a073-d3259ec62415
          metadata:
            papermill:
              duration: 0.004531
              end_time: 2025-11-06T23:56:29.074297
              exception: false
              start_time: 2025-11-06T23:56:29.069766
              status: completed
            tags: []
          sortingKey: "0"
          type: markdown
        - blockGroup: 70764a1e-fb3b-4e69-8c21-05a1a2830251
          content: >+
            ## Downloading the data

            Dataset:
            https://huggingface.co/datasets/Booking-com/accommodation-reviews


            - Manual method: Clicking through the website and downloading files
            one by one (cumbersome)

            - Automatic method: Integrate the URL in the code and download
            automatically (convenient)

          id: 66e4656e-0c66-4c31-865d-95cc11896db7
          metadata:
            papermill:
              duration: 0.003408
              end_time: 2025-11-06T23:56:29.082743
              exception: false
              start_time: 2025-11-06T23:56:29.079335
              status: completed
            tags: []
          sortingKey: "1"
          type: markdown
        - blockGroup: 30c35f60-e5e2-4080-8c6a-407a137a0bda
          content: >-
            import polars as pl

            from pathlib import Path


            # Set save directory to Kaggle working environment

            save_data_dir = Path('/kaggle/working/rectour24/')


            # Create directory if it doesn't exist

            if not save_data_dir.exists():
                save_data_dir.mkdir(parents=True)

            hf_data_dir =
            'hf://datasets/Booking-com/accommodation-reviews/rectour24/'


            # names of files, as specified in the repository

            data_names = [
                'train_reviews',
                'val_reviews',
                'test_reviews'
            ]


            for data_name in data_names:
                data = pl.read_csv(f"{hf_data_dir}{data_name}.csv")
                data.write_csv(save_data_dir / f"{data_name}.csv")
                print(f"{data_name} saved")
          executionCount: 1
          id: 9acb97b3-25eb-41df-94d4-555d526d5191
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:56:29.090760Z
              iopub.status.busy: 2025-11-06T23:56:29.090527Z
              iopub.status.idle: 2025-11-06T23:56:38.631494Z
              shell.execute_reply: 2025-11-06T23:56:38.630596Z
            papermill:
              duration: 9.54644
              end_time: 2025-11-06T23:56:38.632779
              exception: false
              start_time: 2025-11-06T23:56:29.086339
              status: completed
            tags: []
          outputs:
            - name: stdout
              output_type: stream
              text:
                - |
                  train_reviews saved
                - |
                  val_reviews saved
                - |
                  test_reviews saved
          sortingKey: "2"
          type: code
        - blockGroup: 824d0114-8f6a-403b-a6a0-3aa69b179a6c
          content: |
            ## Introduction to the tools
            ### Hugging Face Transformers
            Hugging Face Transformers is an open-source library that revolutionized Natural Language Processing (NLP) by making state-of-the-art language models easily accessible. The library provides thousands of pre-trained models covering tasks like text classification, translation, summarization, and more. Its intuitive API allows seamless integration with both PyTorch and TensorFlow, supporting rapid experimentation, training, and deployment in real-world applications. Recent transformer architectures, like BERT, RoBERTa, and GPT, are the backbone of many breakthroughs in NLP. 

            Read more about HF Transformers [here](https://huggingface.co/docs/transformers/en/index).

            ### PyTorch
            PyTorch is a powerful, flexible deep learning framework popular for research and production. It offers dynamic computation graphs ("define-by-run"), making it intuitive to debug and iterate through models. PyTorch seamlessly integrates with GPU acceleration, allowing scalable training of sophisticated neural networks. The framework underpins many NLP, computer vision, and reinforcement learning projects worldwide.

            Read more about PyTorch [here](https://docs.pytorch.org/docs/stable/index.html).

            ### Sentiment Analysis
            Sentiment analysis is a fundamental task in NLP focused on determining the emotional tone or opinion expressed in a piece of text—classifying it as positive, negative, or neutral. It is widely used in fields such as social media monitoring, product feedback, finance, and customer service. Modern sentiment analysis models leverage deep learning to capture subtle nuances in text, achieving higher accuracy than rule-based approaches.

            Read more about sentiment analysis [here](https://www.geeksforgeeks.org/machine-learning/what-is-sentiment-analysis/). 

            ### NLP model
            This tutorial uses the `cardiffnlp/twitter-roberta-base-sentiment-latest model`—a specialized variant of RoBERTa fine-tuned for sentiment analysis on Twitter data. Developed by Cardiff NLP, this model is trained to recognize sentiment in short, informal, social media-style texts, making it well-suited to analyzing tweets, reviews, and similar content. RoBERTa itself is an optimized version of BERT, designed for high performance through longer training and improved data preprocessing. The CardiffNLP model outputs probabilities for negative, neutral, and positive classes, and can be easily loaded via the Hugging Face Transformers API for inference and fine-tuning.

            Read more about this model [here](https://huggingface.co/cardiffnlp/twitter-roberta-base-sentiment-latest).
          id: 0433c398-51eb-48e0-81b7-f112ed98220b
          metadata:
            papermill:
              duration: 0.003515
              end_time: 2025-11-06T23:56:38.640395
              exception: false
              start_time: 2025-11-06T23:56:38.636880
              status: completed
            tags: []
          sortingKey: "3"
          type: markdown
        - blockGroup: db9f6b0b-9aa7-4d1f-8daa-e701e12862e4
          content: |-
            ## Start the analysis
            ### Import libraries
          id: 8e7fe023-bca1-4f08-80dd-2820fe2b4eff
          metadata:
            papermill:
              duration: 0.003432
              end_time: 2025-11-06T23:56:38.647402
              exception: false
              start_time: 2025-11-06T23:56:38.643970
              status: completed
            tags: []
          sortingKey: "4"
          type: markdown
        - blockGroup: a5e31588-aeef-408e-a612-11ecd1e9d3c6
          content: >-
            !uv pip install --quiet transformers

            import polars as pl

            from transformers import AutoModelForSequenceClassification,
            AutoTokenizer, AutoConfig

            import numpy as np

            from scipy.special import softmax

            from tqdm.notebook import tqdm

            import torch

            import gc

            from pathlib import Path


            import matplotlib.pyplot as plt

            import seaborn as sns
          executionCount: 2
          id: 129430fc-8837-4f3f-933a-588f8af4a5ed
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:56:38.655275Z
              iopub.status.busy: 2025-11-06T23:56:38.655053Z
              iopub.status.idle: 2025-11-06T23:56:53.418131Z
              shell.execute_reply: 2025-11-06T23:56:53.417467Z
            papermill:
              duration: 14.76858
              end_time: 2025-11-06T23:56:53.419494
              exception: false
              start_time: 2025-11-06T23:56:38.650914
              status: completed
            tags: []
          outputs: []
          sortingKey: "5"
          type: code
        - blockGroup: 3055b11a-0a3d-4363-a01b-bf732be296af
          content: "### Load the data"
          id: 2a699e7b-209f-4efc-b077-f890e57badee
          metadata:
            papermill:
              duration: 0.003413
              end_time: 2025-11-06T23:56:53.426854
              exception: false
              start_time: 2025-11-06T23:56:53.423441
              status: completed
            tags: []
          sortingKey: "6"
          type: markdown
        - blockGroup: 28472f9a-299d-4da7-9126-ad52d1074040
          content: |-
            # load dataset
            data_dir = "/kaggle/working/rectour24/"

            train_reviews = pl.read_csv(data_dir + "train_reviews.csv")
            valid_reviews = pl.read_csv(data_dir + "val_reviews.csv")
            test_reviews = pl.read_csv(data_dir + "test_reviews.csv")
          executionCount: 3
          id: fe29fd8e-fa93-4c40-a879-d2f1fba74d30
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:56:53.434861Z
              iopub.status.busy: 2025-11-06T23:56:53.434475Z
              iopub.status.idle: 2025-11-06T23:56:54.175211Z
              shell.execute_reply: 2025-11-06T23:56:54.174335Z
            papermill:
              duration: 0.746373
              end_time: 2025-11-06T23:56:54.176660
              exception: false
              start_time: 2025-11-06T23:56:53.430287
              status: completed
            tags: []
          outputs: []
          sortingKey: "7"
          type: code
        - blockGroup: 37cbbe20-4c92-40d3-ae65-4d5803e74f4c
          content: >-
            ### Brief exploratory data analysis


            The dataset contains the following columns:


            | 'review_id'| 'accommodation_id' |  'review_title' |
            'review_positive' |  'review_negative' |  'review_score'
            |  'review_helpful_votes' |


            And the files contain the following number of rows:

            - `train_reviews`: 1,628,989

            - `valid_reviews`: 203,787

            - `test_reviews`: 199,138
          id: 3fe1df5f-9f41-4d8c-bcab-bb5930af8daf
          metadata:
            papermill:
              duration: 0.00355
              end_time: 2025-11-06T23:56:54.186868
              exception: false
              start_time: 2025-11-06T23:56:54.183318
              status: completed
            tags: []
          sortingKey: "8"
          type: markdown
        - blockGroup: 00cd0ab4-989a-4177-ac02-7c278a968052
          content: train_reviews
          executionCount: 4
          id: 927fcb05-fab6-4bd8-94c5-ba76a8c9145f
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:56:54.195491Z
              iopub.status.busy: 2025-11-06T23:56:54.195210Z
              iopub.status.idle: 2025-11-06T23:56:54.210631Z
              shell.execute_reply: 2025-11-06T23:56:54.209928Z
            papermill:
              duration: 0.020911
              end_time: 2025-11-06T23:56:54.211750
              exception: false
              start_time: 2025-11-06T23:56:54.190839
              status: completed
            tags: []
          outputs:
            - data:
                text/html:
                  - |
                    <div><style>
                  - |
                    .dataframe > thead > tr,
                  - |
                    .dataframe > tbody > tr {
                  - |2
                      text-align: right;
                  - |2
                      white-space: pre-wrap;
                  - |
                    }
                  - |
                    </style>
                  - '<small>shape: (1_628_989, 7)</small><table border="1"
                    class="dataframe"><thead><tr><th>review_id</th><th>accommodation_id</th><th>review_title</th><th>review_positive</th><th>review_negative</th><th>review_score</th><th>review_helpful_votes</th></tr><tr><td>str</td><td>i64</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>i64</td></tr></thead><tbody><tr><td>&quot;bf762eec-0e44-42ff-a066-6be55a…</td><td>489020669</td><td>&quot;Nice
                    &amp;amp; friendly , Plenty o…</td><td>&quot;Really nice
                    staff. Good food.F…</td><td>&quot;woken up 2.30 in the
                    morning
                    b…</td><td>10.0</td><td>0</td></tr><tr><td>&quot;3f1a116f-38ed-4fe8-9086-fd71b0…</td><td>1533822482</td><td>null</td><td>&quot;The
                    staff was helpful and the …</td><td>&quot;They only placed
                    one wash
                    clot…</td><td>9.0</td><td>0</td></tr><tr><td>&quot;2cfd21e7-4e2d-4a31-be9d-9e22c7…</td><td>222537300</td><td>null</td><td>&quot;&amp;quot;Home
                    Sweet Home&amp;quot;
                    is…</td><td>null</td><td>10.0</td><td>3</td></tr><tr><td>&quot;a240f502-0ee3-47e3-964b-786b56…</td><td>644485349</td><td>null</td><td>&quot;We
                    havent stayed in a b&amp;amp;b
                    …</td><td>null</td><td>9.0</td><td>0</td></tr><tr><td>&quot;5086e380-21d4-4d5c-be6f-f2d04a…</td><td>-192152850</td><td>null</td><td>&quot;Location
                    bed and pillows
                    where…</td><td>null</td><td>10.0</td><td>0</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;58b117be-d221-4db7-8d6a-29656c…</td><td>2013313501</td><td>null</td><td>&quot;Great
                    location for walking uph…</td><td>&quot;Starbucks closes at
                    5pm and I
                    …</td><td>10.0</td><td>0</td></tr><tr><td>&quot;99c40951-637f-4faf-913c-773e45…</td><td>-617199527</td><td>null</td><td>&quot;The
                    hotel is located in the
                    ci…</td><td>null</td><td>10.0</td><td>0</td></tr><tr><td>&quot;c63fdfb0-2c67-4801-b1f8-bdff2e…</td><td>1745110448</td><td>&quot;Great
                    stay for a great price&quot;</td><td>&quot;Loved the view
                    and the room (v…</td><td>&quot;Nothing I can think
                    of&quot;</td><td>7.0</td><td>0</td></tr><tr><td>&quot;65a309cf-17d8-4828-aa7a-7ab46b…</td><td>-1740040086</td><td>&quot;Great
                    Historic Location&quot;</td><td>&quot;Character property
                    with a
                    spac…</td><td>null</td><td>9.0</td><td>0</td></tr><tr><td>&quot;6dd2daa1-a585-4060-9220-f8e847…</td><td>1702020661</td><td>&quot;Great
                    hotel in a lovely town.&quot;</td><td>&quot;I think the
                    cleanest hotel roo…</td><td>&quot;Can’t think of anything
                    about
                    …</td><td>10.0</td><td>0</td></tr></tbody></table></div>'
                text/plain:
                  - |
                    shape: (1_628_989, 7)
                  - |
                    ┌──────────────┬─────────────┬─────────────┬─────────────┬─────────────┬─────────────┬─────────────┐
                  - >
                    │ review_id    ┆ accommodati ┆ review_titl ┆ review_posi ┆
                    review_nega ┆ review_scor ┆ review_help │
                  - >
                    │ ---          ┆ on_id       ┆ e           ┆ tive        ┆
                    tive        ┆ e           ┆ ful_votes   │
                  - >
                    │ str          ┆ ---         ┆ ---         ┆ ---         ┆
                    ---         ┆ ---         ┆ ---         │
                  - >
                    │              ┆ i64         ┆ str         ┆ str         ┆
                    str         ┆ f64         ┆ i64         │
                  - |
                    ╞══════════════╪═════════════╪═════════════╪═════════════╪═════════════╪═════════════╪═════════════╡
                  - >
                    │ bf762eec-0e4 ┆ 489020669   ┆ Nice &amp;  ┆ Really nice ┆
                    woken up    ┆ 10.0        ┆ 0           │
                  - >
                    │ 4-42ff-a066- ┆             ┆ friendly ,  ┆ staff. Good ┆
                    2.30 in the ┆             ┆             │
                  - >
                    │ 6be55a…      ┆             ┆ Plenty o…   ┆ food.F…     ┆
                    morning b…  ┆             ┆             │
                  - >
                    │ 3f1a116f-38e ┆ 1533822482  ┆ null        ┆ The staff   ┆
                    They only   ┆ 9.0         ┆ 0           │
                  - >
                    │ d-4fe8-9086- ┆             ┆             ┆ was helpful ┆
                    placed one  ┆             ┆             │
                  - >
                    │ fd71b0…      ┆             ┆             ┆ and the …   ┆
                    wash clot…  ┆             ┆             │
                  - >
                    │ 2cfd21e7-4e2 ┆ 222537300   ┆ null        ┆ &quot;Home  ┆
                    null        ┆ 10.0        ┆ 3           │
                  - >
                    │ d-4a31-be9d- ┆             ┆             ┆
                    Sweet       ┆             ┆             ┆             │
                  - >
                    │ 9e22c7…      ┆             ┆             ┆
                    Home&quot;  ┆             ┆             ┆             │
                  - >
                    │              ┆             ┆             ┆
                    is…         ┆             ┆             ┆             │
                  - >
                    │ a240f502-0ee ┆ 644485349   ┆ null        ┆ We havent   ┆
                    null        ┆ 9.0         ┆ 0           │
                  - >
                    │ 3-47e3-964b- ┆             ┆             ┆ stayed in a
                    ┆             ┆             ┆             │
                  - >
                    │ 786b56…      ┆             ┆             ┆ b&amp;b
                    …   ┆             ┆             ┆             │
                  - >
                    │ 5086e380-21d ┆ -192152850  ┆ null        ┆ Location    ┆
                    null        ┆ 10.0        ┆ 0           │
                  - >
                    │ 4-4d5c-be6f- ┆             ┆             ┆ bed
                    and     ┆             ┆             ┆             │
                  - >
                    │ f2d04a…      ┆             ┆             ┆
                    pillows     ┆             ┆             ┆             │
                  - >
                    │              ┆             ┆             ┆
                    where…      ┆             ┆             ┆             │
                  - >
                    │ …            ┆ …           ┆ …           ┆ …           ┆
                    …           ┆ …           ┆ …           │
                  - >
                    │ 58b117be-d22 ┆ 2013313501  ┆ null        ┆ Great       ┆
                    Starbucks   ┆ 10.0        ┆ 0           │
                  - >
                    │ 1-4db7-8d6a- ┆             ┆             ┆ location    ┆
                    closes at   ┆             ┆             │
                  - >
                    │ 29656c…      ┆             ┆             ┆ for walking ┆
                    5pm and I … ┆             ┆             │
                  - >
                    │              ┆             ┆             ┆
                    uph…        ┆             ┆             ┆             │
                  - >
                    │ 99c40951-637 ┆ -617199527  ┆ null        ┆ The hotel   ┆
                    null        ┆ 10.0        ┆ 0           │
                  - >
                    │ f-4faf-913c- ┆             ┆             ┆ is
                    located  ┆             ┆             ┆             │
                  - >
                    │ 773e45…      ┆             ┆             ┆ in the
                    ci…  ┆             ┆             ┆             │
                  - >
                    │ c63fdfb0-2c6 ┆ 1745110448  ┆ Great stay  ┆ Loved the   ┆
                    Nothing I   ┆ 7.0         ┆ 0           │
                  - >
                    │ 7-4801-b1f8- ┆             ┆ for a great ┆ view and    ┆
                    can think   ┆             ┆             │
                  - >
                    │ bdff2e…      ┆             ┆ price       ┆ the room    ┆
                    of          ┆             ┆             │
                  - >
                    │              ┆             ┆             ┆
                    (v…         ┆             ┆             ┆             │
                  - >
                    │ 65a309cf-17d ┆ -1740040086 ┆ Great       ┆ Character   ┆
                    null        ┆ 9.0         ┆ 0           │
                  - >
                    │ 8-4828-aa7a- ┆             ┆ Historic    ┆
                    property    ┆             ┆             ┆             │
                  - >
                    │ 7ab46b…      ┆             ┆ Location    ┆ with
                    a      ┆             ┆             ┆             │
                  - >
                    │              ┆             ┆             ┆
                    spac…       ┆             ┆             ┆             │
                  - >
                    │ 6dd2daa1-a58 ┆ 1702020661  ┆ Great hotel ┆ I think the ┆
                    Can’t think ┆ 10.0        ┆ 0           │
                  - >
                    │ 5-4060-9220- ┆             ┆ in a lovely ┆ cleanest    ┆
                    of anything ┆             ┆             │
                  - >
                    │ f8e847…      ┆             ┆ town.       ┆ hotel roo…  ┆
                    about …     ┆             ┆             │
                  - └──────────────┴─────────────┴─────────────┴─────────────┴─────────────┴─────────────┴─────────────┘
              execution_count: 4
              metadata: {}
              output_type: execute_result
          sortingKey: "9"
          type: code
        - blockGroup: d9a05bbc-874d-4dc1-b582-8654a871c30e
          content: "## Setup the NLP Model and PyTorch"
          id: 02e9023c-4c8c-4af9-93cf-0908dc7ffaf3
          metadata:
            papermill:
              duration: 0.003666
              end_time: 2025-11-06T23:56:54.219232
              exception: false
              start_time: 2025-11-06T23:56:54.215566
              status: completed
            tags: []
          sortingKey: a
          type: markdown
        - blockGroup: 1704b03f-0963-410e-9048-fd416c8e2f03
          content: >-
            # model definition

            # Preprocess text (username and link placeholders)

            def preprocess(text):
                new_text = []
                for t in text.split(" "):
                    t = '@user' if t.startswith('@') and len(t) > 1 else t
                    t = 'http' if t.startswith('http') else t
                    new_text.append(t)
                return " ".join(new_text)
            MODEL = f"cardiffnlp/twitter-roberta-base-sentiment-latest"

            tokenizer = AutoTokenizer.from_pretrained(MODEL)

            config = AutoConfig.from_pretrained(MODEL)

            # PT

            model = AutoModelForSequenceClassification.from_pretrained(MODEL)


            model.config.use_cache = False

            model.resize_token_embeddings(len(tokenizer))



            device = torch.device("cuda" if torch.cuda.is_available() else
            "cpu")

            model.to(device)

            model.eval()
          executionCount: 5
          id: 381d19e9-8318-4a3e-ae79-e8d7b2f0f1f1
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:56:54.227888Z
              iopub.status.busy: 2025-11-06T23:56:54.227456Z
              iopub.status.idle: 2025-11-06T23:57:12.553487Z
              shell.execute_reply: 2025-11-06T23:57:12.552726Z
            papermill:
              duration: 18.331829
              end_time: 2025-11-06T23:57:12.554890
              exception: false
              start_time: 2025-11-06T23:56:54.223061
              status: completed
            tags: []
          outputs:
            - data:
                application/vnd.jupyter.widget-view+json:
                  model_id: 065f229c7754495cac2df8f24437b824
                  version_major: 2
                  version_minor: 0
                text/plain:
                  - "config.json:   0%|          | 0.00/929 [00:00<?, ?B/s]"
              metadata: {}
              output_type: display_data
            - data:
                application/vnd.jupyter.widget-view+json:
                  model_id: d4495e14dbf34503b20191257fc9d86d
                  version_major: 2
                  version_minor: 0
                text/plain:
                  - "vocab.json: 0.00B [00:00, ?B/s]"
              metadata: {}
              output_type: display_data
            - data:
                application/vnd.jupyter.widget-view+json:
                  model_id: 79a3cb7a5166411fb393c053e1586256
                  version_major: 2
                  version_minor: 0
                text/plain:
                  - "merges.txt: 0.00B [00:00, ?B/s]"
              metadata: {}
              output_type: display_data
            - data:
                application/vnd.jupyter.widget-view+json:
                  model_id: 6961369ac6694f73b523d53fd6cefa55
                  version_major: 2
                  version_minor: 0
                text/plain:
                  - "special_tokens_map.json:   0%|          | 0.00/239
                    [00:00<?, ?B/s]"
              metadata: {}
              output_type: display_data
            - name: stderr
              output_type: stream
              text:
                - >
                  2025-11-06 23:56:59.095036: E
                  external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477]
                  Unable to register cuFFT factory: Attempting to register
                  factory for plugin cuFFT when one has already been registered
                - >
                  WARNING: All log messages before absl::InitializeLog() is
                  called are written to STDERR
                - >
                  E0000 00:00:1762473419.288822      19 cuda_dnn.cc:8310] Unable
                  to register cuDNN factory: Attempting to register factory for
                  plugin cuDNN when one has already been registered
                - >
                  E0000 00:00:1762473419.338357      19 cuda_blas.cc:1418]
                  Unable to register cuBLAS factory: Attempting to register
                  factory for plugin cuBLAS when one has already been registered
            - data:
                application/vnd.jupyter.widget-view+json:
                  model_id: 4f789660f3fb409b817395c60a4d69c2
                  version_major: 2
                  version_minor: 0
                text/plain:
                  - "pytorch_model.bin:   0%|          | 0.00/501M [00:00<?,
                    ?B/s]"
              metadata: {}
              output_type: display_data
            - name: stderr
              output_type: stream
              text:
                - >
                  Some weights of the model checkpoint at
                  cardiffnlp/twitter-roberta-base-sentiment-latest were not used
                  when initializing RobertaForSequenceClassification:
                  ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']
                - >
                  - This IS expected if you are initializing
                  RobertaForSequenceClassification from the checkpoint of a
                  model trained on another task or with another architecture
                  (e.g. initializing a BertForSequenceClassification model from
                  a BertForPreTraining model).
                - >
                  - This IS NOT expected if you are initializing
                  RobertaForSequenceClassification from the checkpoint of a
                  model that you expect to be exactly identical (initializing a
                  BertForSequenceClassification model from a
                  BertForSequenceClassification model).
            - data:
                text/plain:
                  - |
                    RobertaForSequenceClassification(
                  - |2
                      (roberta): RobertaModel(
                  - |2
                        (embeddings): RobertaEmbeddings(
                  - >2
                          (word_embeddings): Embedding(50265, 768, padding_idx=1)
                  - >2
                          (position_embeddings): Embedding(514, 768,
                    padding_idx=1)
                  - |2
                          (token_type_embeddings): Embedding(1, 768)
                  - >2
                          (LayerNorm): LayerNorm((768,), eps=1e-05,
                    elementwise_affine=True)
                  - |2
                          (dropout): Dropout(p=0.1, inplace=False)
                  - |2
                        )
                  - |2
                        (encoder): RobertaEncoder(
                  - |2
                          (layer): ModuleList(
                  - |2
                            (0-11): 12 x RobertaLayer(
                  - |2
                              (attention): RobertaAttention(
                  - |2
                                (self): RobertaSdpaSelfAttention(
                  - >2
                                  (query): Linear(in_features=768,
                    out_features=768, bias=True)
                  - >2
                                  (key): Linear(in_features=768,
                    out_features=768, bias=True)
                  - >2
                                  (value): Linear(in_features=768,
                    out_features=768, bias=True)
                  - |2
                                  (dropout): Dropout(p=0.1, inplace=False)
                  - |2
                                )
                  - |2
                                (output): RobertaSelfOutput(
                  - >2
                                  (dense): Linear(in_features=768,
                    out_features=768, bias=True)
                  - >2
                                  (LayerNorm): LayerNorm((768,), eps=1e-05,
                    elementwise_affine=True)
                  - |2
                                  (dropout): Dropout(p=0.1, inplace=False)
                  - |2
                                )
                  - |2
                              )
                  - |2
                              (intermediate): RobertaIntermediate(
                  - >2
                                (dense): Linear(in_features=768,
                    out_features=3072, bias=True)
                  - |2
                                (intermediate_act_fn): GELUActivation()
                  - |2
                              )
                  - |2
                              (output): RobertaOutput(
                  - >2
                                (dense): Linear(in_features=3072,
                    out_features=768, bias=True)
                  - >2
                                (LayerNorm): LayerNorm((768,), eps=1e-05,
                    elementwise_affine=True)
                  - |2
                                (dropout): Dropout(p=0.1, inplace=False)
                  - |2
                              )
                  - |2
                            )
                  - |2
                          )
                  - |2
                        )
                  - |2
                      )
                  - |2
                      (classifier): RobertaClassificationHead(
                  - >2
                        (dense): Linear(in_features=768, out_features=768,
                    bias=True)
                  - |2
                        (dropout): Dropout(p=0.1, inplace=False)
                  - >2
                        (out_proj): Linear(in_features=768, out_features=3,
                    bias=True)
                  - |2
                      )
                  - )
              execution_count: 5
              metadata: {}
              output_type: execute_result
          sortingKey: b
          type: code
        - blockGroup: a9209a99-b026-4224-a805-530e017aa573
          content: >
            def sentiment_score(text):
                # Ensure device is defined
                if 'device' not in globals():
                    global device
                    device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
                
                text = preprocess(text)
                encoded_input = tokenizer(text, return_tensors='pt').to(device)
                with torch.no_grad():  # Disable gradient calculation for inference
                    output = model(**encoded_input)
                scores = output.logits[0]
                scores = softmax(scores.cpu().numpy())  # Move to CPU before converting to numpy
                return scores
          executionCount: 6
          id: c6148783-8d53-4fe2-b463-93b96e55c09b
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:57:12.567169Z
              iopub.status.busy: 2025-11-06T23:57:12.566597Z
              iopub.status.idle: 2025-11-06T23:57:12.572010Z
              shell.execute_reply: 2025-11-06T23:57:12.571293Z
            papermill:
              duration: 0.012622
              end_time: 2025-11-06T23:57:12.573306
              exception: false
              start_time: 2025-11-06T23:57:12.560684
              status: completed
            tags: []
          outputs: []
          sortingKey: c
          type: code
        - blockGroup: cf799084-6cf0-457e-b9ac-847ac58ddcc4
          content: |-
            # test
            sentiment_score("Covid cases are increasing fast!")
          executionCount: 7
          id: cb1ef90b-d8a5-4da5-bb8a-c019d9e2e4fd
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:57:12.584283Z
              iopub.status.busy: 2025-11-06T23:57:12.584038Z
              iopub.status.idle: 2025-11-06T23:57:12.910730Z
              shell.execute_reply: 2025-11-06T23:57:12.910065Z
            papermill:
              duration: 0.333523
              end_time: 2025-11-06T23:57:12.911858
              exception: false
              start_time: 2025-11-06T23:57:12.578335
              status: completed
            tags: []
          outputs:
            - data:
                application/vnd.jupyter.widget-view+json:
                  model_id: 5224228f3a88495cbe8cb42f03191276
                  version_major: 2
                  version_minor: 0
                text/plain:
                  - "model.safetensors:   0%|          | 0.00/501M [00:00<?,
                    ?B/s]"
              metadata: {}
              output_type: display_data
            - data:
                text/plain:
                  - array([0.72357666, 0.228679  , 0.04774431], dtype=float32)
              execution_count: 7
              metadata: {}
              output_type: execute_result
          sortingKey: d
          type: code
        - blockGroup: a95f2d78-d7e9-4d5c-af7c-f76943c8bf49
          content: sentiment_score("AI is increasing worker productivity")
          executionCount: 8
          id: a47f46bd-a662-447d-997c-d50965db5387
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:57:12.922264Z
              iopub.status.busy: 2025-11-06T23:57:12.922020Z
              iopub.status.idle: 2025-11-06T23:57:12.934884Z
              shell.execute_reply: 2025-11-06T23:57:12.934326Z
            papermill:
              duration: 0.019014
              end_time: 2025-11-06T23:57:12.935831
              exception: false
              start_time: 2025-11-06T23:57:12.916817
              status: completed
            tags: []
          outputs:
            - data:
                text/plain:
                  - array([0.00744043, 0.07173729, 0.92082226], dtype=float32)
              execution_count: 8
              metadata: {}
              output_type: execute_result
          sortingKey: e
          type: code
        - blockGroup: 0428e5b4-c549-428a-8d73-ee310d41d3fe
          content: sentiment_score("AI is killing worker productivity")
          executionCount: 9
          id: 9192fd24-3bb0-4d21-aee8-e1cb14c00de4
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:57:12.945777Z
              iopub.status.busy: 2025-11-06T23:57:12.945577Z
              iopub.status.idle: 2025-11-06T23:57:12.958358Z
              shell.execute_reply: 2025-11-06T23:57:12.957785Z
            papermill:
              duration: 0.018914
              end_time: 2025-11-06T23:57:12.959422
              exception: false
              start_time: 2025-11-06T23:57:12.940508
              status: completed
            tags: []
          outputs:
            - data:
                text/plain:
                  - array([0.83918566, 0.14199126, 0.01882305], dtype=float32)
              execution_count: 9
              metadata: {}
              output_type: execute_result
          sortingKey: f
          type: code
        - blockGroup: 66ab7878-b630-400b-bbb1-e2a0ec348e7f
          content: >-
            # Batch processing

            def sentiment_score_batch(texts):
                # Ensure device is defined
                if 'device' not in globals():
                    global device
                    device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
                
                preprocessed_texts = [preprocess(text) for text in texts]
                encoded_input = tokenizer(
                    preprocessed_texts,
                    return_tensors='pt',
                    padding=True,
                    truncation=True,
                    max_length=514,
                ).to(device)

                with torch.no_grad():
                    output = model(**encoded_input)
                    scores = output.logits
                    scores = softmax(scores.cpu().numpy(), axis=1)  # Move to CPU and apply softmax

                torch.cuda.empty_cache()
                del encoded_input
                gc.collect()

                return scores

            # Process in batches

            batch_size = 5000  # Adjust this based on your GPU memory capacity

            review_title_scores = []


            # Select top 10% of the rows to reduce time

            num_rows = train_reviews.height 

            top_10_percent = int(num_rows * 0.1)  

            head_10pc_train_reviews = train_reviews.head(top_10_percent)


            # for i in tqdm(range(0, len(train_reviews), batch_size)):
                # batch_texts = train_reviews['review_title'].to_numpy()[i:i+batch_size]
            for i in tqdm(range(0, len(head_10pc_train_reviews), batch_size)):
                batch_texts = head_10pc_train_reviews['review_title'].to_numpy()[i:i+batch_size]

                # Identify None values
                none_mask = [text is None for text in batch_texts]

                # Filter out None values for processing
                valid_texts = [text for text in batch_texts if text is not None]

                if valid_texts:
                    # Get sentiment scores for non-None values
                    batch_scores = sentiment_score_batch(valid_texts)
                else:
                    batch_scores = np.array([]).reshape(0, 3)  # Empty array for empty valid_texts

                # Initialize full scores array with zeros for None values
                full_scores = np.zeros((len(batch_texts), 3))

                # Insert the computed scores back into the appropriate positions
                valid_idx = 0
                for j, is_none in enumerate(none_mask):
                    if not is_none:
                        full_scores[j] = batch_scores[valid_idx]
                        valid_idx += 1

                review_title_scores.append(full_scores)

            review_title_scores = np.vstack(review_title_scores)
          executionCount: 10
          id: dd62dd40-7b3f-483a-9911-dbcbfd98247c
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:57:12.969976Z
              iopub.status.busy: 2025-11-06T23:57:12.969745Z
              iopub.status.idle: 2025-11-06T23:59:40.557927Z
              shell.execute_reply: 2025-11-06T23:59:40.557338Z
            papermill:
              duration: 147.595306
              end_time: 2025-11-06T23:59:40.559396
              exception: false
              start_time: 2025-11-06T23:57:12.964090
              status: completed
            tags: []
          outputs:
            - data:
                application/vnd.jupyter.widget-view+json:
                  model_id: f5ed92e43c104e618f20636292c23e71
                  version_major: 2
                  version_minor: 0
                text/plain:
                  - "  0%|          | 0/33 [00:00<?, ?it/s]"
              metadata: {}
              output_type: display_data
          sortingKey: g
          type: code
        - blockGroup: b509778c-49dd-437e-b721-21db8dbaa3a4
          content: review_title_scores.shape
          executionCount: 11
          id: 6a14d997-5f55-489a-a190-552b764e5b77
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:59:40.570763Z
              iopub.status.busy: 2025-11-06T23:59:40.570320Z
              iopub.status.idle: 2025-11-06T23:59:40.574874Z
              shell.execute_reply: 2025-11-06T23:59:40.574131Z
            papermill:
              duration: 0.011642
              end_time: 2025-11-06T23:59:40.576351
              exception: false
              start_time: 2025-11-06T23:59:40.564709
              status: completed
            tags: []
          outputs:
            - data:
                text/plain:
                  - (162898, 3)
              execution_count: 11
              metadata: {}
              output_type: execute_result
          sortingKey: h
          type: code
        - blockGroup: d84d6e05-8cab-4065-b265-4f57d7174648
          content: |-
            head_10pc_train_reviews = (
                head_10pc_train_reviews.with_columns(
                    review_title_negative=pl.Series(review_title_scores[:, 0]),
                    review_title_neutral=pl.Series(review_title_scores[:, 1]),
                    review_title_positive=pl.Series(review_title_scores[:, 2]),
                )
            )
          executionCount: 12
          id: e1e574bc-39d6-4442-948f-ad051adac107
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:59:40.586950Z
              iopub.status.busy: 2025-11-06T23:59:40.586470Z
              iopub.status.idle: 2025-11-06T23:59:40.607102Z
              shell.execute_reply: 2025-11-06T23:59:40.606566Z
            papermill:
              duration: 0.02698
              end_time: 2025-11-06T23:59:40.608105
              exception: false
              start_time: 2025-11-06T23:59:40.581125
              status: completed
            tags: []
          outputs: []
          sortingKey: i
          type: code
        - blockGroup: 5eaa9a11-2ccb-42e7-8bd8-7447498167c6
          content: head_10pc_train_reviews
          executionCount: 13
          id: 249e7d6f-f570-44ad-a8e6-1747b95ad706
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:59:40.618425Z
              iopub.status.busy: 2025-11-06T23:59:40.618215Z
              iopub.status.idle: 2025-11-06T23:59:40.625967Z
              shell.execute_reply: 2025-11-06T23:59:40.625311Z
            papermill:
              duration: 0.014138
              end_time: 2025-11-06T23:59:40.627065
              exception: false
              start_time: 2025-11-06T23:59:40.612927
              status: completed
            tags: []
          outputs:
            - data:
                text/html:
                  - |
                    <div><style>
                  - |
                    .dataframe > thead > tr,
                  - |
                    .dataframe > tbody > tr {
                  - |2
                      text-align: right;
                  - |2
                      white-space: pre-wrap;
                  - |
                    }
                  - |
                    </style>
                  - '<small>shape: (162_898, 10)</small><table border="1"
                    class="dataframe"><thead><tr><th>review_id</th><th>accommodation_id</th><th>review_title</th><th>review_positive</th><th>review_negative</th><th>review_score</th><th>review_helpful_votes</th><th>review_title_negative</th><th>review_title_neutral</th><th>review_title_positive</th></tr><tr><td>str</td><td>i64</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>i64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;bf762eec-0e44-42ff-a066-6be55a…</td><td>489020669</td><td>&quot;Nice
                    &amp;amp; friendly , Plenty o…</td><td>&quot;Really nice
                    staff. Good food.F…</td><td>&quot;woken up 2.30 in the
                    morning
                    b…</td><td>10.0</td><td>0</td><td>0.006272</td><td>0.030829</td><td>0.962899</td></tr><tr><td>&quot;3f1a116f-38ed-4fe8-9086-fd71b0…</td><td>1533822482</td><td>null</td><td>&quot;The
                    staff was helpful and the …</td><td>&quot;They only placed
                    one wash
                    clot…</td><td>9.0</td><td>0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&quot;2cfd21e7-4e2d-4a31-be9d-9e22c7…</td><td>222537300</td><td>null</td><td>&quot;&amp;quot;Home
                    Sweet Home&amp;quot;
                    is…</td><td>null</td><td>10.0</td><td>3</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&quot;a240f502-0ee3-47e3-964b-786b56…</td><td>644485349</td><td>null</td><td>&quot;We
                    havent stayed in a b&amp;amp;b
                    …</td><td>null</td><td>9.0</td><td>0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&quot;5086e380-21d4-4d5c-be6f-f2d04a…</td><td>-192152850</td><td>null</td><td>&quot;Location
                    bed and pillows
                    where…</td><td>null</td><td>10.0</td><td>0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;7ed297ea-b6fa-42cf-8f47-24e640…</td><td>-2144097448</td><td>null</td><td>&quot;Located
                    on the waterfront and
                    …</td><td>null</td><td>10.0</td><td>0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&quot;d647a0c4-d912-4d5a-9722-01c23a…</td><td>-1084815414</td><td>&quot;Good
                    location but maintenance …</td><td>&quot;-Bed was super
                    comfortable. I …</td><td>&quot;-Not clear if there&amp;#39;s
                    a
                    cl…</td><td>6.0</td><td>0</td><td>0.079638</td><td>0.328265</td><td>0.592097</td></tr><tr><td>&quot;9234e4bc-56c2-4b7a-b7ea-af9b0f…</td><td>-437051311</td><td>&quot;Good&quot;</td><td>&quot;Location
                    , pool , staff&quot;</td><td>&quot;The massage and hammam
                    were a
                    …</td><td>10.0</td><td>0</td><td>0.052735</td><td>0.262828</td><td>0.684437</td></tr><tr><td>&quot;b01c9f20-0473-45f1-a79b-3d9a6b…</td><td>-1556971278</td><td>&quot;Loved
                    T-Bird!&quot;</td><td>&quot;The hotel is retro and older
                    c…</td><td>&quot;The only drawbacks to the
                    room…</td><td>10.0</td><td>0</td><td>0.004704</td><td>0.017485</td><td>0.977811</td></tr><tr><td>&quot;691fa833-aa2a-43d1-85c6-074255…</td><td>-1804512836</td><td>null</td><td>&quot;Affordable,
                    friendly and clean…</td><td>&quot;The mattress was very
                    uncomfor…</td><td>9.0</td><td>0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr></tbody></table></div>'
                text/plain:
                  - |
                    shape: (162_898, 10)
                  - |
                    ┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
                  - >
                    │ review_id ┆ accommoda ┆ review_ti ┆ review_po ┆ … ┆
                    review_he ┆ review_ti ┆ review_ti ┆ review_t │
                  - >
                    │ ---       ┆ tion_id   ┆ tle       ┆ sitive    ┆   ┆
                    lpful_vot ┆ tle_negat ┆ tle_neutr ┆ itle_pos │
                  - >
                    │ str       ┆ ---       ┆ ---       ┆ ---       ┆   ┆
                    es        ┆ ive       ┆ al        ┆ itive    │
                  - >
                    │           ┆ i64       ┆ str       ┆ str       ┆   ┆
                    ---       ┆ ---       ┆ ---       ┆ ---      │
                  - >
                    │           ┆           ┆           ┆           ┆   ┆
                    i64       ┆ f64       ┆ f64       ┆ f64      │
                  - |
                    ╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
                  - >
                    │ bf762eec- ┆ 489020669 ┆ Nice      ┆ Really    ┆ … ┆
                    0         ┆ 0.006272  ┆ 0.030829  ┆ 0.962899 │
                  - |
                    │ 0e44-42ff ┆           ┆ &amp;     ┆ nice      ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -a066-6be ┆           ┆ friendly  ┆ staff.    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ 55a…      ┆           ┆ , Plenty  ┆ Good      ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │           ┆           ┆ o…        ┆ food.F…   ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 3f1a116f- ┆ 153382248 ┆ null      ┆ The staff ┆ … ┆
                    0         ┆ 0.0       ┆ 0.0       ┆ 0.0      │
                  - |
                    │ 38ed-4fe8 ┆ 2         ┆           ┆ was       ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -9086-fd7 ┆           ┆           ┆ helpful   ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 1b0…      ┆           ┆           ┆ and the …
                    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 2cfd21e7- ┆ 222537300 ┆ null      ┆ &quot;Hom ┆ … ┆
                    3         ┆ 0.0       ┆ 0.0       ┆ 0.0      │
                  - >
                    │ 4e2d-4a31 ┆           ┆           ┆ e
                    Sweet   ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -be9d-9e2 ┆           ┆           ┆ Home&quot
                    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 2c7…      ┆           ┆           ┆ ;
                    is…     ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ a240f502- ┆ 644485349 ┆ null      ┆ We havent ┆ … ┆
                    0         ┆ 0.0       ┆ 0.0       ┆ 0.0      │
                  - >
                    │ 0ee3-47e3 ┆           ┆           ┆ stayed in
                    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -964b-786 ┆           ┆           ┆ a b&amp;b
                    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ b56…      ┆           ┆           ┆ …         ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 5086e380- ┆ -19215285 ┆ null      ┆ Location  ┆ … ┆
                    0         ┆ 0.0       ┆ 0.0       ┆ 0.0      │
                  - >
                    │ 21d4-4d5c ┆ 0         ┆           ┆ bed
                    and   ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -be6f-f2d ┆           ┆           ┆ pillows   ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ 04a…      ┆           ┆           ┆ where…    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ …         ┆ …         ┆ …         ┆ …         ┆ … ┆
                    …         ┆ …         ┆ …         ┆ …        │
                  - >
                    │ 7ed297ea- ┆ -21440974 ┆ null      ┆ Located   ┆ … ┆
                    0         ┆ 0.0       ┆ 0.0       ┆ 0.0      │
                  - >
                    │ b6fa-42cf ┆ 48        ┆           ┆ on
                    the    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -8f47-24e ┆           ┆           ┆ waterfron
                    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 640…      ┆           ┆           ┆ t and
                    …   ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ d647a0c4- ┆ -10848154 ┆ Good      ┆ -Bed was  ┆ … ┆
                    0         ┆ 0.079638  ┆ 0.328265  ┆ 0.592097 │
                  - >
                    │ d912-4d5a ┆ 14        ┆ location  ┆ super com
                    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -9722-01c ┆           ┆ but maint ┆ fortable.
                    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 23a…      ┆           ┆ enance …  ┆ I
                    …       ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 9234e4bc- ┆ -43705131 ┆ Good      ┆ Location  ┆ … ┆
                    0         ┆ 0.052735  ┆ 0.262828  ┆ 0.684437 │
                  - >
                    │ 56c2-4b7a ┆ 1         ┆           ┆ , pool
                    ,  ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -b7ea-af9 ┆           ┆           ┆ staff     ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ b0f…      ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ b01c9f20- ┆ -15569712 ┆ Loved     ┆ The hotel ┆ … ┆
                    0         ┆ 0.004704  ┆ 0.017485  ┆ 0.977811 │
                  - >
                    │ 0473-45f1 ┆ 78        ┆ T-Bird!   ┆ is
                    retro  ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -a79b-3d9 ┆           ┆           ┆ and older
                    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ a6b…      ┆           ┆           ┆ c…        ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 691fa833- ┆ -18045128 ┆ null      ┆ Affordabl ┆ … ┆
                    0         ┆ 0.0       ┆ 0.0       ┆ 0.0      │
                  - |
                    │ aa2a-43d1 ┆ 36        ┆           ┆ e,        ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -85c6-074 ┆           ┆           ┆ friendly  ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ 255…      ┆           ┆           ┆ and       ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │           ┆           ┆           ┆ clean…    ┆   ┆           ┆           ┆           ┆          │
                  - └───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘
              execution_count: 13
              metadata: {}
              output_type: execute_result
          sortingKey: j
          type: code
        - blockGroup: d9fe4e60-cb1a-49e0-8c97-099eddeb19fd
          content: valid_reviews
          executionCount: 14
          id: ad8e4b1b-9cea-45ba-947a-e15cf920d76a
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:59:40.638203Z
              iopub.status.busy: 2025-11-06T23:59:40.637659Z
              iopub.status.idle: 2025-11-06T23:59:40.643537Z
              shell.execute_reply: 2025-11-06T23:59:40.642837Z
            papermill:
              duration: 0.012608
              end_time: 2025-11-06T23:59:40.644784
              exception: false
              start_time: 2025-11-06T23:59:40.632176
              status: completed
            tags: []
          outputs:
            - data:
                text/html:
                  - |
                    <div><style>
                  - |
                    .dataframe > thead > tr,
                  - |
                    .dataframe > tbody > tr {
                  - |2
                      text-align: right;
                  - |2
                      white-space: pre-wrap;
                  - |
                    }
                  - |
                    </style>
                  - '<small>shape: (203_787, 7)</small><table border="1"
                    class="dataframe"><thead><tr><th>review_id</th><th>accommodation_id</th><th>review_title</th><th>review_positive</th><th>review_negative</th><th>review_score</th><th>review_helpful_votes</th></tr><tr><td>str</td><td>i64</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>i64</td></tr></thead><tbody><tr><td>&quot;bc875f5f-d6b3-4257-8657-c32438…</td><td>1715638058</td><td>&quot;Simple,
                    quiet, clean accommoda…</td><td>&quot;Simple, quiet, clean
                    accommoda…</td><td>null</td><td>7.0</td><td>0</td></tr><tr><td>&quot;1255bfb6-4474-47c5-ab95-039bde…</td><td>392754076</td><td>&quot;Great
                    location, nice gardens a…</td><td>&quot;Great pool with
                    shade, nice ga…</td><td>&quot;Room was nice just a little
                    da…</td><td>8.0</td><td>0</td></tr><tr><td>&quot;07b6070b-ea7b-4780-badd-517080…</td><td>-1438158622</td><td>&quot;Lovely
                    relaxing hotel, great v…</td><td>&quot;The food was lovely
                    and the po…</td><td>&quot;My one complaint is that the
                    t…</td><td>10.0</td><td>0</td></tr><tr><td>&quot;4f350d78-4540-41c1-b5e5-13d9e1…</td><td>-1703391740</td><td>&quot;Excellent
                    - Highly recommend b…</td><td>&quot;The place is hard to
                    find.
                    But…</td><td>null</td><td>9.0</td><td>0</td></tr><tr><td>&quot;5f25926b-f16b-41b6-836f-b5f016…</td><td>653876828</td><td>null</td><td>&quot;Hotel
                    was very nice, clean, co…</td><td>&quot;Location was ok,
                    just a bit
                    of…</td><td>9.0</td><td>0</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;960bd395-7b0c-4343-9173-e6c250…</td><td>198865257</td><td>&quot;Excellent
                    location to shops, c…</td><td>&quot;Excellent location and
                    value
                    f…</td><td>null</td><td>10.0</td><td>0</td></tr><tr><td>&quot;1e3f012e-59cb-49ba-9f94-0c7033…</td><td>972221007</td><td>&quot;Modern,
                    clean and high spec ap…</td><td>&quot;Super modern and clean
                    apartme…</td><td>&quot;Na&quot;</td><td>8.0</td><td>0</td></tr><tr><td>&quot;beb7ebb9-e650-41b9-adfa-eadcf2…</td><td>1767990297</td><td>&quot;Modern
                    apartment s for a low p…</td><td>&quot;Amazing modern
                    apartment s, in…</td><td>&quot;Nothing not to like..
                    Everythi…</td><td>10.0</td><td>0</td></tr><tr><td>&quot;a8bf9d76-5f68-4553-aecd-dbccf6…</td><td>693269630</td><td>null</td><td>&quot;I
                    enjoyed my stay staff were
                    v…</td><td>null</td><td>10.0</td><td>0</td></tr><tr><td>&quot;2d39cd0d-b7fc-4b09-9d3f-ea1db9…</td><td>2084206415</td><td>null</td><td>&quot;The
                    accommodation was very mod…</td><td>&quot;Only some
                    unpleasant smell
                    fro…</td><td>8.0</td><td>0</td></tr></tbody></table></div>'
                text/plain:
                  - |
                    shape: (203_787, 7)
                  - |
                    ┌──────────────┬─────────────┬─────────────┬─────────────┬─────────────┬─────────────┬─────────────┐
                  - >
                    │ review_id    ┆ accommodati ┆ review_titl ┆ review_posi ┆
                    review_nega ┆ review_scor ┆ review_help │
                  - >
                    │ ---          ┆ on_id       ┆ e           ┆ tive        ┆
                    tive        ┆ e           ┆ ful_votes   │
                  - >
                    │ str          ┆ ---         ┆ ---         ┆ ---         ┆
                    ---         ┆ ---         ┆ ---         │
                  - >
                    │              ┆ i64         ┆ str         ┆ str         ┆
                    str         ┆ f64         ┆ i64         │
                  - |
                    ╞══════════════╪═════════════╪═════════════╪═════════════╪═════════════╪═════════════╪═════════════╡
                  - >
                    │ bc875f5f-d6b ┆ 1715638058  ┆ Simple,     ┆ Simple,     ┆
                    null        ┆ 7.0         ┆ 0           │
                  - >
                    │ 3-4257-8657- ┆             ┆ quiet,      ┆
                    quiet,      ┆             ┆             ┆             │
                  - >
                    │ c32438…      ┆             ┆ clean       ┆
                    clean       ┆             ┆             ┆             │
                  - >
                    │              ┆             ┆ accommoda…  ┆
                    accommoda…  ┆             ┆             ┆             │
                  - >
                    │ 1255bfb6-447 ┆ 392754076   ┆ Great       ┆ Great pool  ┆
                    Room was    ┆ 8.0         ┆ 0           │
                  - >
                    │ 4-47c5-ab95- ┆             ┆ location,   ┆ with shade, ┆
                    nice just a ┆             ┆             │
                  - >
                    │ 039bde…      ┆             ┆ nice        ┆ nice ga…    ┆
                    little da…  ┆             ┆             │
                  - |
                    │              ┆             ┆ gardens a…  ┆             ┆             ┆             ┆             │
                  - >
                    │ 07b6070b-ea7 ┆ -1438158622 ┆ Lovely      ┆ The food    ┆
                    My one      ┆ 10.0        ┆ 0           │
                  - >
                    │ b-4780-badd- ┆             ┆ relaxing    ┆ was lovely  ┆
                    complaint   ┆             ┆             │
                  - >
                    │ 517080…      ┆             ┆ hotel,      ┆ and the po… ┆
                    is that the ┆             ┆             │
                  - >
                    │              ┆             ┆ great v…    ┆             ┆
                    t…          ┆             ┆             │
                  - >
                    │ 4f350d78-454 ┆ -1703391740 ┆ Excellent - ┆ The place   ┆
                    null        ┆ 9.0         ┆ 0           │
                  - >
                    │ 0-41c1-b5e5- ┆             ┆ Highly      ┆ is hard
                    to  ┆             ┆             ┆             │
                  - >
                    │ 13d9e1…      ┆             ┆ recommend   ┆ find.
                    But…  ┆             ┆             ┆             │
                  - |
                    │              ┆             ┆ b…          ┆             ┆             ┆             ┆             │
                  - >
                    │ 5f25926b-f16 ┆ 653876828   ┆ null        ┆ Hotel was   ┆
                    Location    ┆ 9.0         ┆ 0           │
                  - >
                    │ b-41b6-836f- ┆             ┆             ┆ very nice,  ┆
                    was ok,     ┆             ┆             │
                  - >
                    │ b5f016…      ┆             ┆             ┆ clean, co…  ┆
                    just a bit  ┆             ┆             │
                  - >
                    │              ┆             ┆             ┆             ┆
                    of…         ┆             ┆             │
                  - >
                    │ …            ┆ …           ┆ …           ┆ …           ┆
                    …           ┆ …           ┆ …           │
                  - >
                    │ 960bd395-7b0 ┆ 198865257   ┆ Excellent   ┆ Excellent   ┆
                    null        ┆ 10.0        ┆ 0           │
                  - >
                    │ c-4343-9173- ┆             ┆ location to ┆
                    location    ┆             ┆             ┆             │
                  - >
                    │ e6c250…      ┆             ┆ shops, c…   ┆ and
                    value   ┆             ┆             ┆             │
                  - >
                    │              ┆             ┆             ┆
                    f…          ┆             ┆             ┆             │
                  - >
                    │ 1e3f012e-59c ┆ 972221007   ┆ Modern,     ┆ Super       ┆
                    Na          ┆ 8.0         ┆ 0           │
                  - >
                    │ b-49ba-9f94- ┆             ┆ clean and   ┆ modern
                    and  ┆             ┆             ┆             │
                  - >
                    │ 0c7033…      ┆             ┆ high spec   ┆
                    clean       ┆             ┆             ┆             │
                  - >
                    │              ┆             ┆ ap…         ┆
                    apartme…    ┆             ┆             ┆             │
                  - >
                    │ beb7ebb9-e65 ┆ 1767990297  ┆ Modern      ┆ Amazing     ┆
                    Nothing not ┆ 10.0        ┆ 0           │
                  - >
                    │ 0-41b9-adfa- ┆             ┆ apartment s ┆ modern      ┆
                    to like..   ┆             ┆             │
                  - >
                    │ eadcf2…      ┆             ┆ for a low   ┆ apartment   ┆
                    Everythi…   ┆             ┆             │
                  - >
                    │              ┆             ┆ p…          ┆ s,
                    in…      ┆             ┆             ┆             │
                  - >
                    │ a8bf9d76-5f6 ┆ 693269630   ┆ null        ┆ I enjoyed   ┆
                    null        ┆ 10.0        ┆ 0           │
                  - >
                    │ 8-4553-aecd- ┆             ┆             ┆ my
                    stay     ┆             ┆             ┆             │
                  - >
                    │ dbccf6…      ┆             ┆             ┆ staff
                    were  ┆             ┆             ┆             │
                  - >
                    │              ┆             ┆             ┆
                    v…          ┆             ┆             ┆             │
                  - >
                    │ 2d39cd0d-b7f ┆ 2084206415  ┆ null        ┆ The accommo ┆
                    Only some   ┆ 8.0         ┆ 0           │
                  - >
                    │ c-4b09-9d3f- ┆             ┆             ┆ dation was  ┆
                    unpleasant  ┆             ┆             │
                  - >
                    │ ea1db9…      ┆             ┆             ┆ very mod…   ┆
                    smell fro…  ┆             ┆             │
                  - └──────────────┴─────────────┴─────────────┴─────────────┴─────────────┴─────────────┴─────────────┘
              execution_count: 14
              metadata: {}
              output_type: execute_result
          sortingKey: k
          type: code
        - blockGroup: 31cd8903-001c-4348-97a7-25290fbd3be9
          content: >-
            def sentiment_analysis_batch(texts:np.ndarray, batch_size:int):
                review_scores = []

                for i in tqdm(range(0, len(texts), batch_size)):
                    batch_texts = texts[i:i+batch_size]

                    # Identify None values
                    none_mask = [text is None for text in batch_texts]

                    # Filter out None values for processing
                    valid_texts = [text for text in batch_texts if text is not None]

                    if valid_texts:
                        # Get sentiment scores for non-None values
                        batch_scores = sentiment_score_batch(valid_texts)
                    else:
                        batch_scores = np.array([]).reshape(0, 3)  # Empty array for empty valid_texts

                    # Initialize full scores array with zeros for None values
                    full_scores = np.zeros((len(batch_texts), 3))

                    # Insert the computed scores back into the appropriate positions
                    valid_idx = 0
                    for j, is_none in enumerate(none_mask):
                        if not is_none:
                            full_scores[j] = batch_scores[valid_idx]
                            valid_idx += 1

                    review_scores.append(full_scores)

                review_scores = np.vstack(review_scores)

                # torch.cuda.empty_cache()
                # gc.collect()

                return review_scores
          executionCount: 15
          id: 54ea7026-f6aa-4e30-9881-55e4c56d34c9
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:59:40.656686Z
              iopub.status.busy: 2025-11-06T23:59:40.656040Z
              iopub.status.idle: 2025-11-06T23:59:40.664141Z
              shell.execute_reply: 2025-11-06T23:59:40.663438Z
            papermill:
              duration: 0.015006
              end_time: 2025-11-06T23:59:40.665294
              exception: false
              start_time: 2025-11-06T23:59:40.650288
              status: completed
            tags: []
          outputs: []
          sortingKey: l
          type: code
        - blockGroup: a9862130-ea1d-40a3-b4c5-9e35a439581e
          content: |-
            # Select top 10% of the rows to reduce time
            num_rows = valid_reviews.height 
            top_10_percent = int(num_rows * 0.1)  
            head_10pc_valid_reviews = valid_reviews.head(top_10_percent)

            # valid_review_title_scores = sentiment_analysis_batch(valid_reviews['review_title'].to_numpy(), batch_size=256)
            valid_review_title_scores = sentiment_analysis_batch(head_10pc_valid_reviews['review_title'].to_numpy(), batch_size=5000)
          executionCount: 16
          id: 6f8df6f4-8c10-41eb-a5e6-b406398eefb1
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:59:40.676366Z
              iopub.status.busy: 2025-11-06T23:59:40.676117Z
              iopub.status.idle: 2025-11-06T23:59:58.502792Z
              shell.execute_reply: 2025-11-06T23:59:58.502221Z
            papermill:
              duration: 17.833529
              end_time: 2025-11-06T23:59:58.504053
              exception: false
              start_time: 2025-11-06T23:59:40.670524
              status: completed
            tags: []
          outputs:
            - data:
                application/vnd.jupyter.widget-view+json:
                  model_id: e71fa6f6bf6e492eba4ceeacdd289bec
                  version_major: 2
                  version_minor: 0
                text/plain:
                  - "  0%|          | 0/5 [00:00<?, ?it/s]"
              metadata: {}
              output_type: display_data
          sortingKey: m
          type: code
        - blockGroup: 0a276b0b-f956-4032-96bf-6b082c3ab6a3
          content: head_10pc_valid_reviews
          executionCount: 17
          id: e9a52d0a-c24c-4b24-9732-b04e46f0fad0
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:59:58.516409Z
              iopub.status.busy: 2025-11-06T23:59:58.516178Z
              iopub.status.idle: 2025-11-06T23:59:58.522591Z
              shell.execute_reply: 2025-11-06T23:59:58.521895Z
            papermill:
              duration: 0.01383
              end_time: 2025-11-06T23:59:58.523863
              exception: false
              start_time: 2025-11-06T23:59:58.510033
              status: completed
            tags: []
          outputs:
            - data:
                text/html:
                  - |
                    <div><style>
                  - |
                    .dataframe > thead > tr,
                  - |
                    .dataframe > tbody > tr {
                  - |2
                      text-align: right;
                  - |2
                      white-space: pre-wrap;
                  - |
                    }
                  - |
                    </style>
                  - '<small>shape: (20_378, 7)</small><table border="1"
                    class="dataframe"><thead><tr><th>review_id</th><th>accommodation_id</th><th>review_title</th><th>review_positive</th><th>review_negative</th><th>review_score</th><th>review_helpful_votes</th></tr><tr><td>str</td><td>i64</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>i64</td></tr></thead><tbody><tr><td>&quot;bc875f5f-d6b3-4257-8657-c32438…</td><td>1715638058</td><td>&quot;Simple,
                    quiet, clean accommoda…</td><td>&quot;Simple, quiet, clean
                    accommoda…</td><td>null</td><td>7.0</td><td>0</td></tr><tr><td>&quot;1255bfb6-4474-47c5-ab95-039bde…</td><td>392754076</td><td>&quot;Great
                    location, nice gardens a…</td><td>&quot;Great pool with
                    shade, nice ga…</td><td>&quot;Room was nice just a little
                    da…</td><td>8.0</td><td>0</td></tr><tr><td>&quot;07b6070b-ea7b-4780-badd-517080…</td><td>-1438158622</td><td>&quot;Lovely
                    relaxing hotel, great v…</td><td>&quot;The food was lovely
                    and the po…</td><td>&quot;My one complaint is that the
                    t…</td><td>10.0</td><td>0</td></tr><tr><td>&quot;4f350d78-4540-41c1-b5e5-13d9e1…</td><td>-1703391740</td><td>&quot;Excellent
                    - Highly recommend b…</td><td>&quot;The place is hard to
                    find.
                    But…</td><td>null</td><td>9.0</td><td>0</td></tr><tr><td>&quot;5f25926b-f16b-41b6-836f-b5f016…</td><td>653876828</td><td>null</td><td>&quot;Hotel
                    was very nice, clean, co…</td><td>&quot;Location was ok,
                    just a bit
                    of…</td><td>9.0</td><td>0</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;5834bd5c-75bb-46e0-8b24-7263ef…</td><td>-1807522361</td><td>&quot;Wonderful
                    and convenient locat…</td><td>&quot;Wonderful and convenient
                    locat…</td><td>null</td><td>10.0</td><td>0</td></tr><tr><td>&quot;8b0116ff-85bc-4112-94e2-dd3ffd…</td><td>1024241486</td><td>&quot;pleasant
                    for short stay&quot;</td><td>&quot;convenient location, nice
                    rece…</td><td>&quot;rooms were clean but very
                    shab…</td><td>6.0</td><td>0</td></tr><tr><td>&quot;c280569b-4996-4ef5-bd66-123ba3…</td><td>-958690930</td><td>&quot;We
                    had a wonderful 2 nights at…</td><td>&quot;Delicious
                    breakfast with a
                    bea…</td><td>&quot;Nothing&quot;</td><td>8.0</td><td>0</td></tr><tr><td>&quot;9e4a6e16-05cc-4bd1-9725-0675db…</td><td>-375121988</td><td>null</td><td>&quot;Location
                    close to
                    city&quot;</td><td>null</td><td>8.0</td><td>0</td></tr><tr><td>&quot;03a016fa-5abe-4cbc-b5be-1ced74…</td><td>803567415</td><td>&quot;The
                    Beach was exactly what we …</td><td>&quot;We LOVED our stay
                    here at The …</td><td>&quot;Absolutely
                    nothing&quot;</td><td>10.0</td><td>0</td></tr></tbody></table></div>'
                text/plain:
                  - |
                    shape: (20_378, 7)
                  - |
                    ┌──────────────┬─────────────┬─────────────┬─────────────┬─────────────┬─────────────┬─────────────┐
                  - >
                    │ review_id    ┆ accommodati ┆ review_titl ┆ review_posi ┆
                    review_nega ┆ review_scor ┆ review_help │
                  - >
                    │ ---          ┆ on_id       ┆ e           ┆ tive        ┆
                    tive        ┆ e           ┆ ful_votes   │
                  - >
                    │ str          ┆ ---         ┆ ---         ┆ ---         ┆
                    ---         ┆ ---         ┆ ---         │
                  - >
                    │              ┆ i64         ┆ str         ┆ str         ┆
                    str         ┆ f64         ┆ i64         │
                  - |
                    ╞══════════════╪═════════════╪═════════════╪═════════════╪═════════════╪═════════════╪═════════════╡
                  - >
                    │ bc875f5f-d6b ┆ 1715638058  ┆ Simple,     ┆ Simple,     ┆
                    null        ┆ 7.0         ┆ 0           │
                  - >
                    │ 3-4257-8657- ┆             ┆ quiet,      ┆
                    quiet,      ┆             ┆             ┆             │
                  - >
                    │ c32438…      ┆             ┆ clean       ┆
                    clean       ┆             ┆             ┆             │
                  - >
                    │              ┆             ┆ accommoda…  ┆
                    accommoda…  ┆             ┆             ┆             │
                  - >
                    │ 1255bfb6-447 ┆ 392754076   ┆ Great       ┆ Great pool  ┆
                    Room was    ┆ 8.0         ┆ 0           │
                  - >
                    │ 4-47c5-ab95- ┆             ┆ location,   ┆ with shade, ┆
                    nice just a ┆             ┆             │
                  - >
                    │ 039bde…      ┆             ┆ nice        ┆ nice ga…    ┆
                    little da…  ┆             ┆             │
                  - |
                    │              ┆             ┆ gardens a…  ┆             ┆             ┆             ┆             │
                  - >
                    │ 07b6070b-ea7 ┆ -1438158622 ┆ Lovely      ┆ The food    ┆
                    My one      ┆ 10.0        ┆ 0           │
                  - >
                    │ b-4780-badd- ┆             ┆ relaxing    ┆ was lovely  ┆
                    complaint   ┆             ┆             │
                  - >
                    │ 517080…      ┆             ┆ hotel,      ┆ and the po… ┆
                    is that the ┆             ┆             │
                  - >
                    │              ┆             ┆ great v…    ┆             ┆
                    t…          ┆             ┆             │
                  - >
                    │ 4f350d78-454 ┆ -1703391740 ┆ Excellent - ┆ The place   ┆
                    null        ┆ 9.0         ┆ 0           │
                  - >
                    │ 0-41c1-b5e5- ┆             ┆ Highly      ┆ is hard
                    to  ┆             ┆             ┆             │
                  - >
                    │ 13d9e1…      ┆             ┆ recommend   ┆ find.
                    But…  ┆             ┆             ┆             │
                  - |
                    │              ┆             ┆ b…          ┆             ┆             ┆             ┆             │
                  - >
                    │ 5f25926b-f16 ┆ 653876828   ┆ null        ┆ Hotel was   ┆
                    Location    ┆ 9.0         ┆ 0           │
                  - >
                    │ b-41b6-836f- ┆             ┆             ┆ very nice,  ┆
                    was ok,     ┆             ┆             │
                  - >
                    │ b5f016…      ┆             ┆             ┆ clean, co…  ┆
                    just a bit  ┆             ┆             │
                  - >
                    │              ┆             ┆             ┆             ┆
                    of…         ┆             ┆             │
                  - >
                    │ …            ┆ …           ┆ …           ┆ …           ┆
                    …           ┆ …           ┆ …           │
                  - >
                    │ 5834bd5c-75b ┆ -1807522361 ┆ Wonderful   ┆ Wonderful   ┆
                    null        ┆ 10.0        ┆ 0           │
                  - >
                    │ b-46e0-8b24- ┆             ┆ and         ┆
                    and         ┆             ┆             ┆             │
                  - >
                    │ 7263ef…      ┆             ┆ convenient  ┆
                    convenient  ┆             ┆             ┆             │
                  - >
                    │              ┆             ┆ locat…      ┆
                    locat…      ┆             ┆             ┆             │
                  - >
                    │ 8b0116ff-85b ┆ 1024241486  ┆ pleasant    ┆ convenient  ┆
                    rooms were  ┆ 6.0         ┆ 0           │
                  - >
                    │ c-4112-94e2- ┆             ┆ for short   ┆ location,   ┆
                    clean but   ┆             ┆             │
                  - >
                    │ dd3ffd…      ┆             ┆ stay        ┆ nice rece…  ┆
                    very shab…  ┆             ┆             │
                  - >
                    │ c280569b-499 ┆ -958690930  ┆ We had a    ┆ Delicious   ┆
                    Nothing     ┆ 8.0         ┆ 0           │
                  - >
                    │ 6-4ef5-bd66- ┆             ┆ wonderful 2 ┆
                    breakfast   ┆             ┆             ┆             │
                  - >
                    │ 123ba3…      ┆             ┆ nights at…  ┆ with a bea…
                    ┆             ┆             ┆             │
                  - >
                    │ 9e4a6e16-05c ┆ -375121988  ┆ null        ┆ Location    ┆
                    null        ┆ 8.0         ┆ 0           │
                  - >
                    │ c-4bd1-9725- ┆             ┆             ┆ close
                    to    ┆             ┆             ┆             │
                  - >
                    │ 0675db…      ┆             ┆             ┆
                    city        ┆             ┆             ┆             │
                  - >
                    │ 03a016fa-5ab ┆ 803567415   ┆ The Beach   ┆ We LOVED    ┆
                    Absolutely  ┆ 10.0        ┆ 0           │
                  - >
                    │ e-4cbc-b5be- ┆             ┆ was exactly ┆ our stay    ┆
                    nothing     ┆             ┆             │
                  - >
                    │ 1ced74…      ┆             ┆ what we …   ┆ here at The
                    ┆             ┆             ┆             │
                  - >
                    │              ┆             ┆             ┆
                    …           ┆             ┆             ┆             │
                  - └──────────────┴─────────────┴─────────────┴─────────────┴─────────────┴─────────────┴─────────────┘
              execution_count: 17
              metadata: {}
              output_type: execute_result
          sortingKey: n
          type: code
        - blockGroup: ceda1e06-88dd-4d43-b383-50961ebcf298
          content: valid_review_title_scores.shape
          executionCount: 18
          id: fd899f50-67a0-4305-9cc6-5eba16b622ab
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:59:58.536142Z
              iopub.status.busy: 2025-11-06T23:59:58.535952Z
              iopub.status.idle: 2025-11-06T23:59:58.540372Z
              shell.execute_reply: 2025-11-06T23:59:58.539631Z
            papermill:
              duration: 0.011798
              end_time: 2025-11-06T23:59:58.541466
              exception: false
              start_time: 2025-11-06T23:59:58.529668
              status: completed
            tags: []
          outputs:
            - data:
                text/plain:
                  - (20378, 3)
              execution_count: 18
              metadata: {}
              output_type: execute_result
          sortingKey: o
          type: code
        - blockGroup: 50b1e451-c15b-4164-acb9-2d789627207f
          content: |-
            # Select top 10% of the rows to reduce time
            num_rows = valid_reviews.height 
            top_10_percent = int(num_rows * 0.1)  
            head_10pc_test_reviews = test_reviews.head(top_10_percent)

            # test_review_title_scores = sentiment_analysis_batch(test_reviews['review_title'].to_numpy(), batch_size=256)
            test_review_title_scores = sentiment_analysis_batch(head_10pc_test_reviews['review_title'].to_numpy(), batch_size=5000)
          executionCount: 19
          id: 71ca8f34-53f1-4d71-917a-92948e8138d1
          metadata:
            execution:
              iopub.execute_input: 2025-11-06T23:59:58.554210Z
              iopub.status.busy: 2025-11-06T23:59:58.553547Z
              iopub.status.idle: 2025-11-07T00:00:16.131505Z
              shell.execute_reply: 2025-11-07T00:00:16.130935Z
            papermill:
              duration: 17.585383
              end_time: 2025-11-07T00:00:16.132605
              exception: false
              start_time: 2025-11-06T23:59:58.547222
              status: completed
            tags: []
          outputs:
            - data:
                application/vnd.jupyter.widget-view+json:
                  model_id: cb7650dbd2474b21aa2fbf1346bd0109
                  version_major: 2
                  version_minor: 0
                text/plain:
                  - "  0%|          | 0/5 [00:00<?, ?it/s]"
              metadata: {}
              output_type: display_data
          sortingKey: p
          type: code
        - blockGroup: 6b66265d-c2ba-4c2c-9c2f-5f581f15e688
          content: >-
            head_10pc_valid_reviews = (
                head_10pc_valid_reviews.with_columns(
                    review_title_negative=pl.Series(valid_review_title_scores[:, 0]),
                    review_title_neutral=pl.Series(valid_review_title_scores[:, 1]),
                    review_title_positive=pl.Series(valid_review_title_scores[:, 2]),
                )
            )


            head_10pc_test_reviews = (
                head_10pc_test_reviews.with_columns(
                    review_title_negative=pl.Series(test_review_title_scores[:, 0]),
                    review_title_neutral=pl.Series(test_review_title_scores[:, 1]),
                    review_title_positive=pl.Series(test_review_title_scores[:, 2]),
                )
            )
          executionCount: 20
          id: 6add3e8c-2abc-4265-9ff5-abb49799e4e4
          metadata:
            execution:
              iopub.execute_input: 2025-11-07T00:00:16.145980Z
              iopub.status.busy: 2025-11-07T00:00:16.145585Z
              iopub.status.idle: 2025-11-07T00:00:16.151229Z
              shell.execute_reply: 2025-11-07T00:00:16.150708Z
            papermill:
              duration: 0.013142
              end_time: 2025-11-07T00:00:16.152338
              exception: false
              start_time: 2025-11-07T00:00:16.139196
              status: completed
            tags: []
          outputs: []
          sortingKey: q
          type: code
        - blockGroup: d6f2a863-b43f-4060-ae9d-5fcc92711a32
          content: head_10pc_valid_reviews
          executionCount: 21
          id: 0522895e-ed10-4f18-9571-e864263ce7bb
          metadata:
            execution:
              iopub.execute_input: 2025-11-07T00:00:16.164889Z
              iopub.status.busy: 2025-11-07T00:00:16.164492Z
              iopub.status.idle: 2025-11-07T00:00:16.170833Z
              shell.execute_reply: 2025-11-07T00:00:16.170126Z
            papermill:
              duration: 0.013687
              end_time: 2025-11-07T00:00:16.171866
              exception: false
              start_time: 2025-11-07T00:00:16.158179
              status: completed
            tags: []
          outputs:
            - data:
                text/html:
                  - |
                    <div><style>
                  - |
                    .dataframe > thead > tr,
                  - |
                    .dataframe > tbody > tr {
                  - |2
                      text-align: right;
                  - |2
                      white-space: pre-wrap;
                  - |
                    }
                  - |
                    </style>
                  - '<small>shape: (20_378, 10)</small><table border="1"
                    class="dataframe"><thead><tr><th>review_id</th><th>accommodation_id</th><th>review_title</th><th>review_positive</th><th>review_negative</th><th>review_score</th><th>review_helpful_votes</th><th>review_title_negative</th><th>review_title_neutral</th><th>review_title_positive</th></tr><tr><td>str</td><td>i64</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>i64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;bc875f5f-d6b3-4257-8657-c32438…</td><td>1715638058</td><td>&quot;Simple,
                    quiet, clean accommoda…</td><td>&quot;Simple, quiet, clean
                    accommoda…</td><td>null</td><td>7.0</td><td>0</td><td>0.033174</td><td>0.35094</td><td>0.615886</td></tr><tr><td>&quot;1255bfb6-4474-47c5-ab95-039bde…</td><td>392754076</td><td>&quot;Great
                    location, nice gardens a…</td><td>&quot;Great pool with
                    shade, nice ga…</td><td>&quot;Room was nice just a little
                    da…</td><td>8.0</td><td>0</td><td>0.002874</td><td>0.014642</td><td>0.982485</td></tr><tr><td>&quot;07b6070b-ea7b-4780-badd-517080…</td><td>-1438158622</td><td>&quot;Lovely
                    relaxing hotel, great v…</td><td>&quot;The food was lovely
                    and the po…</td><td>&quot;My one complaint is that the
                    t…</td><td>10.0</td><td>0</td><td>0.006497</td><td>0.012862</td><td>0.980641</td></tr><tr><td>&quot;4f350d78-4540-41c1-b5e5-13d9e1…</td><td>-1703391740</td><td>&quot;Excellent
                    - Highly recommend b…</td><td>&quot;The place is hard to
                    find.
                    But…</td><td>null</td><td>9.0</td><td>0</td><td>0.00617</td><td>0.013217</td><td>0.980612</td></tr><tr><td>&quot;5f25926b-f16b-41b6-836f-b5f016…</td><td>653876828</td><td>null</td><td>&quot;Hotel
                    was very nice, clean, co…</td><td>&quot;Location was ok,
                    just a bit
                    of…</td><td>9.0</td><td>0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;5834bd5c-75bb-46e0-8b24-7263ef…</td><td>-1807522361</td><td>&quot;Wonderful
                    and convenient locat…</td><td>&quot;Wonderful and convenient
                    locat…</td><td>null</td><td>10.0</td><td>0</td><td>0.002825</td><td>0.012105</td><td>0.98507</td></tr><tr><td>&quot;8b0116ff-85bc-4112-94e2-dd3ffd…</td><td>1024241486</td><td>&quot;pleasant
                    for short stay&quot;</td><td>&quot;convenient location, nice
                    rece…</td><td>&quot;rooms were clean but very
                    shab…</td><td>6.0</td><td>0</td><td>0.019125</td><td>0.224177</td><td>0.756698</td></tr><tr><td>&quot;c280569b-4996-4ef5-bd66-123ba3…</td><td>-958690930</td><td>&quot;We
                    had a wonderful 2 nights at…</td><td>&quot;Delicious
                    breakfast with a
                    bea…</td><td>&quot;Nothing&quot;</td><td>8.0</td><td>0</td><td>0.003422</td><td>0.009615</td><td>0.986963</td></tr><tr><td>&quot;9e4a6e16-05cc-4bd1-9725-0675db…</td><td>-375121988</td><td>null</td><td>&quot;Location
                    close to
                    city&quot;</td><td>null</td><td>8.0</td><td>0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&quot;03a016fa-5abe-4cbc-b5be-1ced74…</td><td>803567415</td><td>&quot;The
                    Beach was exactly what we …</td><td>&quot;We LOVED our stay
                    here at The …</td><td>&quot;Absolutely
                    nothing&quot;</td><td>10.0</td><td>0</td><td>0.003654</td><td>0.018552</td><td>0.977794</td></tr></tbody></table></div>'
                text/plain:
                  - |
                    shape: (20_378, 10)
                  - |
                    ┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
                  - >
                    │ review_id ┆ accommoda ┆ review_ti ┆ review_po ┆ … ┆
                    review_he ┆ review_ti ┆ review_ti ┆ review_t │
                  - >
                    │ ---       ┆ tion_id   ┆ tle       ┆ sitive    ┆   ┆
                    lpful_vot ┆ tle_negat ┆ tle_neutr ┆ itle_pos │
                  - >
                    │ str       ┆ ---       ┆ ---       ┆ ---       ┆   ┆
                    es        ┆ ive       ┆ al        ┆ itive    │
                  - >
                    │           ┆ i64       ┆ str       ┆ str       ┆   ┆
                    ---       ┆ ---       ┆ ---       ┆ ---      │
                  - >
                    │           ┆           ┆           ┆           ┆   ┆
                    i64       ┆ f64       ┆ f64       ┆ f64      │
                  - |
                    ╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
                  - >
                    │ bc875f5f- ┆ 171563805 ┆ Simple,   ┆ Simple,   ┆ … ┆
                    0         ┆ 0.033174  ┆ 0.35094   ┆ 0.615886 │
                  - |
                    │ d6b3-4257 ┆ 8         ┆ quiet,    ┆ quiet,    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -8657-c32 ┆           ┆ clean acc ┆ clean acc
                    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ 438…      ┆           ┆ ommoda…   ┆ ommoda…   ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 1255bfb6- ┆ 392754076 ┆ Great     ┆ Great     ┆ … ┆
                    0         ┆ 0.002874  ┆ 0.014642  ┆ 0.982485 │
                  - >
                    │ 4474-47c5 ┆           ┆ location, ┆ pool with
                    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -ab95-039 ┆           ┆ nice      ┆ shade,    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ bde…      ┆           ┆ gardens   ┆ nice
                    ga…  ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │           ┆           ┆ a…        ┆           ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 07b6070b- ┆ -14381586 ┆ Lovely    ┆ The food  ┆ … ┆
                    0         ┆ 0.006497  ┆ 0.012862  ┆ 0.980641 │
                  - |
                    │ ea7b-4780 ┆ 22        ┆ relaxing  ┆ was       ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -badd-517 ┆           ┆ hotel,    ┆ lovely    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 080…      ┆           ┆ great v…  ┆ and
                    the   ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │           ┆           ┆           ┆ po…       ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 4f350d78- ┆ -17033917 ┆ Excellent ┆ The place ┆ … ┆
                    0         ┆ 0.00617   ┆ 0.013217  ┆ 0.980612 │
                  - >
                    │ 4540-41c1 ┆ 40        ┆ - Highly  ┆ is
                    hard   ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -b5e5-13d ┆           ┆ recommend ┆ to
                    find.  ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ 9e1…      ┆           ┆ b…        ┆ But…      ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 5f25926b- ┆ 653876828 ┆ null      ┆ Hotel was ┆ … ┆
                    0         ┆ 0.0       ┆ 0.0       ┆ 0.0      │
                  - |
                    │ f16b-41b6 ┆           ┆           ┆ very      ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -836f-b5f ┆           ┆           ┆ nice,     ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ 016…      ┆           ┆           ┆ clean,    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │           ┆           ┆           ┆ co…       ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ …         ┆ …         ┆ …         ┆ …         ┆ … ┆
                    …         ┆ …         ┆ …         ┆ …        │
                  - >
                    │ 5834bd5c- ┆ -18075223 ┆ Wonderful ┆ Wonderful ┆ … ┆
                    0         ┆ 0.002825  ┆ 0.012105  ┆ 0.98507  │
                  - >
                    │ 75bb-46e0 ┆ 61        ┆ and conve ┆ and conve
                    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -8b24-726 ┆           ┆ nient     ┆ nient     ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ 3ef…      ┆           ┆ locat…    ┆ locat…    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 8b0116ff- ┆ 102424148 ┆ pleasant  ┆ convenien ┆ … ┆
                    0         ┆ 0.019125  ┆ 0.224177  ┆ 0.756698 │
                  - |
                    │ 85bc-4112 ┆ 6         ┆ for short ┆ t         ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -94e2-dd3 ┆           ┆ stay      ┆ location,
                    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ ffd…      ┆           ┆           ┆ nice      ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │           ┆           ┆           ┆ rece…     ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ c280569b- ┆ -95869093 ┆ We had a  ┆ Delicious ┆ … ┆
                    0         ┆ 0.003422  ┆ 0.009615  ┆ 0.986963 │
                  - >
                    │ 4996-4ef5 ┆ 0         ┆ wonderful ┆ breakfast
                    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -bd66-123 ┆           ┆ 2 nights  ┆ with
                    a    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ ba3…      ┆           ┆ at…       ┆ bea…      ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 9e4a6e16- ┆ -37512198 ┆ null      ┆ Location  ┆ … ┆
                    0         ┆ 0.0       ┆ 0.0       ┆ 0.0      │
                  - >
                    │ 05cc-4bd1 ┆ 8         ┆           ┆ close
                    to  ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -9725-067 ┆           ┆           ┆ city      ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ 5db…      ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 03a016fa- ┆ 803567415 ┆ The Beach ┆ We LOVED  ┆ … ┆
                    0         ┆ 0.003654  ┆ 0.018552  ┆ 0.977794 │
                  - >
                    │ 5abe-4cbc ┆           ┆ was       ┆ our
                    stay  ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -b5be-1ce ┆           ┆ exactly   ┆ here
                    at   ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ d74…      ┆           ┆ what we … ┆ The
                    …     ┆   ┆           ┆           ┆           ┆          │
                  - └───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘
              execution_count: 21
              metadata: {}
              output_type: execute_result
          sortingKey: r
          type: code
        - blockGroup: eb3fb544-4bc3-4f60-8b31-9db4889751f6
          content: head_10pc_test_reviews
          executionCount: 22
          id: f61abb4c-51a4-4d52-b1fa-8d396071900b
          metadata:
            execution:
              iopub.execute_input: 2025-11-07T00:00:16.184696Z
              iopub.status.busy: 2025-11-07T00:00:16.184498Z
              iopub.status.idle: 2025-11-07T00:00:16.190499Z
              shell.execute_reply: 2025-11-07T00:00:16.189817Z
            papermill:
              duration: 0.013516
              end_time: 2025-11-07T00:00:16.191574
              exception: false
              start_time: 2025-11-07T00:00:16.178058
              status: completed
            tags: []
          outputs:
            - data:
                text/html:
                  - |
                    <div><style>
                  - |
                    .dataframe > thead > tr,
                  - |
                    .dataframe > tbody > tr {
                  - |2
                      text-align: right;
                  - |2
                      white-space: pre-wrap;
                  - |
                    }
                  - |
                    </style>
                  - '<small>shape: (20_378, 10)</small><table border="1"
                    class="dataframe"><thead><tr><th>review_id</th><th>accommodation_id</th><th>review_title</th><th>review_positive</th><th>review_negative</th><th>review_score</th><th>review_helpful_votes</th><th>review_title_negative</th><th>review_title_neutral</th><th>review_title_positive</th></tr><tr><td>str</td><td>i64</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>i64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;d50f830f-fd60-492f-924b-46f948…</td><td>-663110570</td><td>null</td><td>&quot;The
                    cabin was very comfortable…</td><td>&quot;Could have done
                    with a couple
                    …</td><td>7.0</td><td>0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&quot;1f03e5f0-f15e-4c7b-997e-0490ce…</td><td>-558978085</td><td>null</td><td>&quot;The
                    breakfast was awesome.
                    The…</td><td>&quot;Nothing.&quot;</td><td>10.0</td><td>0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&quot;01121198-c633-47df-aa4a-b42ef0…</td><td>1477624081</td><td>&quot;Great
                    place to stay in central…</td><td>&quot;I highly recommend
                    this spot
                    i…</td><td>&quot;Nothing.&quot;</td><td>10.0</td><td>0</td><td>0.004134</td><td>0.042763</td><td>0.953103</td></tr><tr><td>&quot;73e3f388-3f51-4091-ad3a-bb6db1…</td><td>-1273110867</td><td>null</td><td>&quot;The
                    room, its location (near
                    Ž…</td><td>null</td><td>9.0</td><td>0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&quot;f181394d-35a0-4e27-9cdc-84427c…</td><td>1244380562</td><td>&quot;delightful
                    apartment in a perf…</td><td>&quot;great location and
                    everything …</td><td>&quot;need to plan where to park
                    bef…</td><td>10.0</td><td>1</td><td>0.004232</td><td>0.0117</td><td>0.984068</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;a882a471-a285-4472-bb91-3d0971…</td><td>-41728243</td><td>&quot;I
                    would definitely stay at the…</td><td>&quot;The food was
                    very good, especi…</td><td>&quot;I lost a pair of favourite
                    ear…</td><td>8.0</td><td>0</td><td>0.005828</td><td>0.256105</td><td>0.738067</td></tr><tr><td>&quot;f118d0e2-cc2c-475d-a6b7-c87e3c…</td><td>-720025442</td><td>&quot;Always
                    appreciate a profession…</td><td>&quot;safe parking at
                    location. prof…</td><td>&quot;A little walk to station (10
                    m…</td><td>8.0</td><td>0</td><td>0.011126</td><td>0.061646</td><td>0.927228</td></tr><tr><td>&quot;94aa67cd-9513-408b-83ac-9e3198…</td><td>-385108466</td><td>&quot;Overnight
                    stay&quot;</td><td>&quot;This was just a stopover on
                    ou…</td><td>&quot;The breakfast was
                    disappointin…</td><td>8.0</td><td>0</td><td>0.02524</td><td>0.869788</td><td>0.104971</td></tr><tr><td>&quot;2ff6a325-76fe-4884-97ac-53df87…</td><td>1810667136</td><td>null</td><td>&quot;Ordinary
                    romm at a good
                    price.…</td><td>null</td><td>8.0</td><td>0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&quot;2af2b98a-4d43-4a03-8ec6-284bff…</td><td>910664918</td><td>&quot;location
                    is great in city cent…</td><td>&quot;location, greeting
                    staff Amir …</td><td>&quot;repair noise coming from
                    upsta…</td><td>7.0</td><td>0</td><td>0.003501</td><td>0.014965</td><td>0.981533</td></tr></tbody></table></div>'
                text/plain:
                  - |
                    shape: (20_378, 10)
                  - |
                    ┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
                  - >
                    │ review_id ┆ accommoda ┆ review_ti ┆ review_po ┆ … ┆
                    review_he ┆ review_ti ┆ review_ti ┆ review_t │
                  - >
                    │ ---       ┆ tion_id   ┆ tle       ┆ sitive    ┆   ┆
                    lpful_vot ┆ tle_negat ┆ tle_neutr ┆ itle_pos │
                  - >
                    │ str       ┆ ---       ┆ ---       ┆ ---       ┆   ┆
                    es        ┆ ive       ┆ al        ┆ itive    │
                  - >
                    │           ┆ i64       ┆ str       ┆ str       ┆   ┆
                    ---       ┆ ---       ┆ ---       ┆ ---      │
                  - >
                    │           ┆           ┆           ┆           ┆   ┆
                    i64       ┆ f64       ┆ f64       ┆ f64      │
                  - |
                    ╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
                  - >
                    │ d50f830f- ┆ -66311057 ┆ null      ┆ The cabin ┆ … ┆
                    0         ┆ 0.0       ┆ 0.0       ┆ 0.0      │
                  - >
                    │ fd60-492f ┆ 0         ┆           ┆ was
                    very  ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -924b-46f ┆           ┆           ┆ comfortab
                    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ 948…      ┆           ┆           ┆ le…       ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 1f03e5f0- ┆ -55897808 ┆ null      ┆ The       ┆ … ┆
                    0         ┆ 0.0       ┆ 0.0       ┆ 0.0      │
                  - >
                    │ f15e-4c7b ┆ 5         ┆           ┆ breakfast
                    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -997e-049 ┆           ┆           ┆ was       ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ 0ce…      ┆           ┆           ┆ awesome.  ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │           ┆           ┆           ┆ The…      ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 01121198- ┆ 147762408 ┆ Great     ┆ I highly  ┆ … ┆
                    0         ┆ 0.004134  ┆ 0.042763  ┆ 0.953103 │
                  - >
                    │ c633-47df ┆ 1         ┆ place to  ┆ recommend
                    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -aa4a-b42 ┆           ┆ stay in   ┆ this spot
                    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ ef0…      ┆           ┆ central…  ┆ i…        ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 73e3f388- ┆ -12731108 ┆ null      ┆ The room, ┆ … ┆
                    0         ┆ 0.0       ┆ 0.0       ┆ 0.0      │
                  - |
                    │ 3f51-4091 ┆ 67        ┆           ┆ its       ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -ad3a-bb6 ┆           ┆           ┆ location  ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ db1…      ┆           ┆           ┆ (near
                    Ž…  ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ f181394d- ┆ 124438056 ┆ delightfu ┆ great     ┆ … ┆
                    1         ┆ 0.004232  ┆ 0.0117    ┆ 0.984068 │
                  - |
                    │ 35a0-4e27 ┆ 2         ┆ l         ┆ location  ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ -9cdc-844 ┆           ┆ apartment ┆ and every
                    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 27c…      ┆           ┆ in a      ┆ thing
                    …   ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │           ┆           ┆ perf…     ┆           ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ …         ┆ …         ┆ …         ┆ …         ┆ … ┆
                    …         ┆ …         ┆ …         ┆ …        │
                  - >
                    │ a882a471- ┆ -41728243 ┆ I would   ┆ The food  ┆ … ┆
                    0         ┆ 0.005828  ┆ 0.256105  ┆ 0.738067 │
                  - >
                    │ a285-4472 ┆           ┆ definitel ┆ was
                    very  ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -bb91-3d0 ┆           ┆ y stay at ┆ good,     ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ 971…      ┆           ┆ the…      ┆ especi…   ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ f118d0e2- ┆ -72002544 ┆ Always    ┆ safe      ┆ … ┆
                    0         ┆ 0.011126  ┆ 0.061646  ┆ 0.927228 │
                  - |
                    │ cc2c-475d ┆ 2         ┆ appreciat ┆ parking   ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -a6b7-c87 ┆           ┆ e a profe ┆ at        ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ e3c…      ┆           ┆ ssion…    ┆ location.
                    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │           ┆           ┆           ┆ prof…     ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 94aa67cd- ┆ -38510846 ┆ Overnight ┆ This was  ┆ … ┆
                    0         ┆ 0.02524   ┆ 0.869788  ┆ 0.104971 │
                  - >
                    │ 9513-408b ┆ 6         ┆ stay      ┆ just
                    a    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -83ac-9e3 ┆           ┆           ┆ stopover  ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 198…      ┆           ┆           ┆ on
                    ou…    ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 2ff6a325- ┆ 181066713 ┆ null      ┆ Ordinary  ┆ … ┆
                    0         ┆ 0.0       ┆ 0.0       ┆ 0.0      │
                  - >
                    │ 76fe-4884 ┆ 6         ┆           ┆ romm at a
                    ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -97ac-53d ┆           ┆           ┆ good      ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ f87…      ┆           ┆           ┆ price.…   ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ 2af2b98a- ┆ 910664918 ┆ location  ┆ location, ┆ … ┆
                    0         ┆ 0.003501  ┆ 0.014965  ┆ 0.981533 │
                  - |
                    │ 4d43-4a03 ┆           ┆ is great  ┆ greeting  ┆   ┆           ┆           ┆           ┆          │
                  - |
                    │ -8ec6-284 ┆           ┆ in city   ┆ staff     ┆   ┆           ┆           ┆           ┆          │
                  - >
                    │ bff…      ┆           ┆ cent…     ┆ Amir
                    …    ┆   ┆           ┆           ┆           ┆          │
                  - └───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘
              execution_count: 22
              metadata: {}
              output_type: execute_result
          sortingKey: s
          type: code
        - blockGroup: 10cf069d-ba97-4ed6-9f54-32894742cfdb
          content: >-
            ## Credits

            The code used in this notebook is taken from
            https://github.com/ty1260/rectour2024_challenge.git
          id: 319e24e8-3ced-44a7-8a6b-d840bf852d81
          metadata:
            papermill:
              duration: 0.006133
              end_time: 2025-11-07T00:00:16.204140
              exception: false
              start_time: 2025-11-07T00:00:16.198007
              status: completed
            tags: []
          sortingKey: t
          type: markdown
      executionMode: block
      id: 804302c8-026d-44e7-a714-4880b1dbb8a4
      isModule: false
      name: tutorial-intro-hugging-face-nlp-pytorch
  settings: {}
version: 1.0.0
